<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study Quiz</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f4f8; color: #333; margin: 0; padding: 0; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
    #container { width: 90%; max-width: 600px; margin: 40px 0; }
    h1 { text-align: center; color: #1a73e8; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; }
    #question { font-weight: bold; font-size:1.1em; margin-bottom:15px; }
    input[type=text] { width:100%; padding:10px; font-size:1em; border:1px solid #ccc; border-radius:5px; margin-bottom:15px; box-sizing:border-box; }
    #button-group { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
    button { flex:1 1 auto; padding:10px 0; font-size:1em; background:#1a73e8; color:#fff; border:none; border-radius:5px; cursor:pointer; transition:0.2s; }
    button:hover { background:#1558b0; }
    #feedback { margin-top:15px; font-weight:bold; color:#d93025; }
    #feedback.correct { color:#188038; }
    #jxgboard { width:100%; height:400px; margin-top:15px; }
    #symbols { display:flex; flex-wrap:wrap; gap:5px; margin-top:10px; }
    #symbols button { flex:0 0 auto; padding:5px 8px; font-size:1em; }
  </style>
</head>
<body>
  <div id="container">
    <h1>Study Quiz</h1>
    <audio id="meow" src="meow.mp3"></audio>

    <div class="card" id="cheatsheet">
      <h2>Cheat Sheet & Symbols</h2>
      <p>Answers ignore spaces and case. Click symbols to insert.</p>
      <div id="symbols"></div>
    </div>

    <div class="card" id="quiz-container">
      <div id="question"></div>
      <input type="text" id="answerBox" placeholder="Type your answer here" />
      <div id="button-group">
        <button id="backBtn">← Back</button>
        <button id="skipBtn">Skip →</button>
        <button id="similarBtn">Similar Q</button>
        <button id="showAnsBtn">Show Solution</button>
        <button id="checkBtn">Check</button>
      </div>
      <div id="feedback"></div>
    </div>

    <div class="card" id="graph-container" style="display:none;">
      <div id="button-group">
        <button id="plotBtn">Plot Curve</button>
        <button id="pointBtn">Add Point</button>
        <button id="clearBtn">Clear</button>
      </div>
      <div id="jxgboard"></div>
      <div id="graphFeedback"></div>
    </div>

  </div>
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <script>
    // Question variants flattened
    const variants = [
      [ {q:'#1 Find the inverse of f(x)=6/(x-9)',a:'9+6/x'}, {q:'Find the inverse of f(x)=8/(x-4)',a:'4+8/x'}, {q:'Find the inverse of f(x)=10/(x-5)',a:'5+10/x'} ],
      [ {q:'#2 Graph y=1/2 e^x',func:'0.5*Math.exp(x)',graph:true,a:''}, {q:'Graph y=2e^x',func:'2*Math.exp(x)',graph:true,a:''}, {q:'Graph y=e^x/3',func:'Math.exp(x)/3',graph:true,a:''} ],
      [ {q:'#3 Change-of-base: log_5(92.42)',a:'ln(92.42)/ln(5)'}, {q:'log_3(45.6)',a:'ln(45.6)/ln(3)'}, {q:'log_7(123)',a:'ln(123)/ln(7)'} ],
      [ {q:'#4 Expand log(x^2 z / y^5)',a:'2log(x)+log(z)-5log(y)'}, {q:'log(a^3 b / c^2)',a:'3log(a)+log(b)-2log(c)'}, {q:'log(mn^4 / p^3)',a:'log(m)+4log(n)-3log(p)'} ],
      [ {q:'#5 Solve log_9(x-8)+log_9(x-8)=1',a:'8+3 or 8-3'}, {q:'log_4(t-2)+log_4(t-2)=2',a:'2+4 or 2-4'}, {q:'log_3(u-1)+log_3(u-1)=1',a:'1+√3 or 1-√3'} ],
      [ {q:'#6 Solve e^{-0.16t}=0.25',a:'ln(0.25)/-0.16'}, {q:'e^{-0.2t}=0.5',a:'ln(0.5)/-0.2'}, {q:'e^{-0.3t}=0.1',a:'ln(0.1)/-0.3'} ],
      [ {q:'#7 Continuous compounding: 4000 at 5.8% for 9 yrs',a:'4000*e^(0.058*9)'}, {q:'5000 at 4% for 10 yrs',a:'5000*e^(0.04*10)'}, {q:'3000 at 6% for 8 yrs',a:'3000*e^(0.06*8)'} ],
      [ {q:'#8 Solve system via Gauss: -6x-7y=-24, -4x+4y=-16',a:'x=2,y=1'}, {q:'3x+5y=15, x-2y=2',a:'x=5,y=0'}, {q:'2x-3y=1, 4x+2y=10',a:'x=2,y=1'} ],
      [ {q:'#9 Multiply BA for A=[1 2;9 7], B=[-5 2;-2 -1]',a:'[13 -2; -11 -11]'}, {q:'Compute BA for A=[2 3;4 5],B=[1 -1;0 2]',a:'[2 4;4 6]'}, {q:'Compute BA for A=[3 4;5 6],B=[2 0;1 1]',a:'[7 4;11 6]'} ],
      [ {q:'#10 Solve via A^-1 for [5 12;2 5] and [7;8]',a:'[x;y]=A^-1*b'}, {q:'Solve [2 3;1 4]^-1*[5;6]',a:'[x;y]'}, {q:'Solve [1 2;3 4]^-1*[3;7]',a:'[x;y]'} ],
      [ {q:'#11 Cramer:4x+3y=1,2x+y=-1',a:'x=(1*1-3*-1)/(4*1-3*2),y=...'}, {q:'5x-2y=3,x+4y=2',a:'x=...;y=...'}, {q:'3x+2y=4,x-3y=5',a:'x=...;y=...'} ],
      [ {q:'#12 Graph circle x^2+y^2+12x+2y+21=0',a:'center(-6,-1),r=sqrt(6^2+1^2-21)'}, {q:'x^2+y^2-4x+6y-12=0',a:'center(2,-3),r=sqrt(4+9+12)'}, {q:'x^2+y^2+8x-10y+9=0',a:'center(-4,5),r=sqrt(16+25-9)'} ]
    ];
    const questions = [].concat(...variants);

    // setup symbols
    const symbols = ['√','^','(',')','/','*','+','-','=','<','>','{','}'];
    const symBox = document.getElementById('symbols');
    symbols.forEach(sym=>{
      const btn=document.createElement('button'); btn.textContent=sym;
      btn.onclick=()=>{
        const el=document.getElementById('answerBox');
        const [s,e]=[el.selectionStart,el.selectionEnd];
        el.value = el.value.slice(0,s)+sym+el.value.slice(e);
        el.focus(); el.selectionStart = el.selectionEnd = s+sym.length;
      };
      symBox.appendChild(btn);
    });

    // JSXGraph board
    let board, addingPoint=false;
    const qs=document.getElementById('question'), fb=document.getElementById('feedback');

    let current=0;
    function loadQuestion(){
      const {q,graph} = questions[current];
      qs.innerHTML=q;
      fb.textContent=''; fb.className='';
      const ansBox=document.getElementById('answerBox');
      ansBox.style.display = graph?'none':'block';
      const gCont=document.getElementById('graph-container');
      gCont.style.display = graph?'block':'none';
      if(graph){
        if(board)JXG.JSXGraph.freeBoard(board);
        board = JXG.JSXGraph.initBoard('jxgboard',{boundingbox:[-10,10,10,-10],axis:true});
      }
    }

    document.getElementById('plotBtn').onclick = ()=>{
      const func = questions[current].func;
      if(board && func){
        board.create('functiongraph',[ x => eval(func) ]);
      }
    };
    document.getElementById('pointBtn').onclick = ()=>{
      addingPoint = true;
      board.on('mousedown', function(e){ if(!addingPoint) return;
        const coords = board.getUsrCoordsOfMouse(e);
        const pt = board.create('point', coords, {size:3, color:'red'});
        const y = eval(questions[current].func.replace(/x/g, `(${coords[0]})`));
        if(Math.abs(coords[1]-y)<0.5){ meow.play(); fb.textContent='Point on curve!'; fb.classList.add('correct'); }
        else fb.textContent='Not on curve.';
        addingPoint=false;
      });
    };
    document.getElementById('clearBtn').onclick = ()=>{ if(board)board.removeObject(board.objectsList.slice()); fb.textContent=''; };

    document.getElementById('checkBtn').onclick = ()=>{
      const input=document.getElementById('answerBox').value.replace(/\s+/g,'').toLowerCase();
      const correct=questions[current].a.replace(/\s+/g,'').toLowerCase();
      if(input===correct){ meow.play(); fb.textContent='Correct!'; fb.classList.add('correct');
        current<questions.length-1? setTimeout(loadQuestion,500):fb.textContent='Quiz Complete!';
      } else fb.textContent='Try again.';
    };
    document.getElementById('showAnsBtn').onclick = ()=>{ fb.textContent='Solution: '+questions[current].a; fb.className=''; };
    document.getElementById('skipBtn').onclick = ()=>{ if(current<questions.length-1) current++; loadQuestion(); };
    document.getElementById('backBtn').onclick = ()=>{ if(current>0) current--; loadQuestion(); };
    document.getElementById('similarBtn').onclick = ()=>{
      const group = Math.floor(current/3);
      const pool = variants[group];
      const pick = pool[Math.floor(Math.random()*pool.length)];
      qs.innerHTML = pick.q; fb.textContent='';
    };

    loadQuestion();
  </script>
</body>
</html>

